<!-- FileThis demo element -->

<!-- Imports -->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../ft-user-interaction-form.html">


<!--

This element defines a number of form examples

@demo demo/index.html
 -->
<dom-module id="demo-fixture">

    <style include="iron-flex iron-flex-alignment"></style>

    <template>

        <div class="layout horizontal start center-justified"
             style="width:100%;
                    padding-left:16px; padding-right:16px;">

            <!-- Credentials -->
            <div style="background:white; border:1px solid #DDD;">
                <ft-user-interaction-form id="credentialsForm"></ft-user-interaction-form>
            </div>

            <!-- Spacer -->
            <div style="width:30px;"></div>

            <!-- Multiple Choice -->
            <div style="background:white; border:1px solid #DDD;">
                <ft-user-interaction-form id="multipleChoiceForm"></ft-user-interaction-form>
            </div>

            <!-- Spacer -->
            <div style="width:30px;"></div>

            <!-- U.S. State -->
            <div style="background:white; border:1px solid #DDD;">
                <ft-user-interaction-form id="_usStateForm"></ft-user-interaction-form>
            </div>

        </div>

    </template>

    <script>

        Polymer
        ({
            is: 'demo-fixture',

            properties:
            {
                version:
                {
                    type: String,  // JSON
                    notify: true,
                    value: "2.0.0",
                    observer: "_onVersionChanged"
                }
            },

            _onVersionChanged: function()
            {
                switch (this.version)
                {
                    case "1.0.0":
                        this._loadRequestIntoForm("credentials", this.$.credentialsForm);
                        this._loadRequestIntoForm("general-choices", this.$.multipleChoiceForm);
                        this._loadRequestIntoForm("us-state", this.$._usStateForm);
                        break;

                    case "2.0.0":
                        // TODO
                        this._loadRequestIntoForm("credentials", this.$.credentialsForm);
                        this._loadRequestIntoForm("general-choices", this.$.multipleChoiceForm);
                        this._loadRequestIntoForm("us-state", this.$._usStateForm);
                        break;

                    default:
                        throw new IllegalArgumentException("Unknown user interaction schema version: " + this.version);
                }
            },

            _loadRequestIntoForm: function(name, form)
            {
                var path = "data/user-interaction-request-" + name + "-example-" + this.version + ".json";

                var xmlHttpRequest = new XMLHttpRequest();
                xmlHttpRequest.overrideMimeType("application/json");
                xmlHttpRequest.open('GET', path, true);
                xmlHttpRequest.onreadystatechange = function()
                {
                    if (xmlHttpRequest.readyState == 4 &&
                        xmlHttpRequest.status == "200")
                    {
                        var json = JSON.parse(xmlHttpRequest.responseText);
                        form.request = json;
                    }
                };
                xmlHttpRequest.send();
            },

            _getMajorVersion: function()
            {
                return this.version.charAt(0);
            }
        });

    </script>

</dom-module>

